---
layout: default
title: Deguの登録・接続
parent: ユーザーマニュアル
nav_order: 40
---

# Deguの登録・接続

Deguゲートウェイに無線LANで接続したスマートフォンやPCを使って、Deguの接続・登録を行うことができます。

## DeguをAWS IoT Coreへ登録する

1. アクセスポイントに接続後、Webブラウザで `http://10.0.0.1/degu/` にアクセスすると、次のようなページが表示されます。

    ![](images/degu_reg_page.jpg)

    アクセスできない場合は次の項目を確認してください。
    * アクセスポイントが正しく設定されているか
    * 異なるアクセスポイントに接続していないか

1. DeguのMACアドレスを登録します。

    MACアドレスを登録するには2つの方法があります。

    * QRコードを読み取る
    * MACアドレスを直接入力する

### QRコードを読み取る

1. `QRコードを読み取る` ボタンをタップすると、カメラが起動します。もし、カメラへのアクセスが許可されていない場合はアクセス許可の設定を行ってください。
PCで接続した場合は、ファイル選択画面が表示されます。このときは、QRコードを撮影した画像をアップロードしてください。

1. Degu本体ケース裏面のQRコードをカメラで撮影します。

    QRコードが小さいと読み込みを行うことができないため、拡大して撮影してください。読み取れない場合は下記のエラーが表示されます。

    ![](images/degu_reg_failed.jpg)

1. 正しく読み込めた場合、`読み取ったQRコード`にMACアドレスが表示されます。表示されている内容がQRコードの左側に記載されている12桁の英数字と一致しているか確認し、`登録`をタップしてください。なお、QRコードの読み込みが失敗した状態(`読み取ったQRコード`が空欄)で`登録`をタップすると、`No mac address`と表示されます。このときは、再度QRコードの読み込みを行ってください。

    ![](images/degu_reg_input.jpg)

### MACアドレスを直接入力する

1. `読み取ったQRコード`の下の欄は、直接MACアドレスを入力することができます。この時、アルファベットは**大文字**で入力してください。空欄の状態で`登録`をタップすると`No mac address`と表示されます。このときは、再度入力を行ってください。なお、入力したMACアドレスの正当性確認は行っておりません。誤った内容で`登録`をタップすると入力した内容のままAWS IoTに登録されてしまい、AWS IoT上での削除操作等が必要になるためご注意ください。

1. `登録`をタップ後、`読み取ったQRコード`の下の欄が空欄になったら登録完了です。AWS IoT Coreの「モノ」に、現在登録したDeguのMACアドレスがデバイスとして登録されていることを確認してください。

    ![degu-registered](images/degu_registered.png)

    次の場合は、AWS IoTに登録されたデバイスを削除し、再度デバイスの登録作業を行ってください。
    * アルファベットの大文字・小文字両方のデバイス名が登録されている
    * MACアドレスと異なる名前で登録されている

    デバイスを削除するには、登録されているモノのページで、`アクション`->`削除` をクリックしてください。
    ![](images/delete_thing.png)

## DeguをDeguゲートウェイへ接続する

1. DeguをAWS IoT Coreに登録してから、5分以内にDeguの電源を入れてください。既にDeguの電源が入っていた場合は、再度電源を入れ直してください。

1. 数十秒後、DeguとDeguゲートウェイとの接続が確立します。接続が確立すると、DeguのLED1が点灯します。

1. Deguゲートウェイが正しくインターネットに接続されている場合、Deguが送信したJSONメッセージが、AWS IoT Core上のモノのシャドウに反映されます。

    ![degu-default-shadow](images/degu_default_shadow.png)

以降、Deguの電源を再度投入しても、自動的にDeguゲートウェイへ接続されます。
